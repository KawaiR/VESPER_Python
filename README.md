# VESPER_Python (*README still in progress*)

VESPER_Python is a computational tool which uses a local vector based algorithm as well as secondary structure matching that can accurately identify the global and local alignment of cryo-electron microscopy (EM) maps. This version provides an option to use probability maps generated by Emap2sec+, another software developed by the Kihara Lab, for secondary strcuture matching.

Emap2sec+: https://github.com/kiharalab/Emap2secPlus \
Original VESPER: https://github.com/kiharalab/VESPER

## Requirements:
* matplotlib
* mrcfile
* numba
* numpy
* pyFFTW
* scipy

To ensure all versions are compatible, run:
```
pip3 install -r requirement.txt --user
```
or
```
pip install -r requirement.txt --user
```

## VESPER_Python protocol

VESPER_Python uses vector based algorithm same as the previous version and along with that it also uses secondary structure mapping in deciding the best superimposition between two maps. The secondary structure mapping is done with the help of Emap2sec+. Emap2sec+ gives the probability of the secondary structure of each voxel of the input mrc map. These probabilities are used to make probability mrc maps which contain the probabilities of each structure. 

## Input Files
* Mode 1 (no secondary structure matching): </br>
  No additional file generation is required. Only the maps used for matching are needed to run the program.
* Mode 2 (w/ secondary structure matching): </br> 
  Probability maps generated for each secondary structure in both maps used for alignment must be generated using Emap2sec+ first and then converted into .npy format using the interpolation script before running this mode.

## Probability Map Generation Pipeline

## Usage

